# TUI 工作流文档

## 概述
本文档集合详细描述了代码上下文生成器TUI界面的各个功能模块的工作流程、交互逻辑和实现细节。这些文档用于指导代码实现验证和测试用例编写。

## 文档结构

### 核心工作流文档
- **[主界面工作流](main-workflow.md)** - 描述TUI主程序的整体架构、状态管理和消息协调机制
- **[文件选择器工作流](file-selector-workflow.md)** - 详细说明文件选择功能的实现逻辑和用户交互流程
- **[结果查看器工作流](result-viewer-workflow.md)** - 阐述扫描结果展示的多标签页界面和交互功能
- **[配置编辑器工作流](config-editor-workflow.md)** - 说明配置管理界面的分类展示和编辑功能
- **[进度条工作流](progress-workflow.md)** - 描述进度显示和状态更新的实现机制
- **[消息系统工作流](message-system.md)** - 解释TUI组件间的通信机制和消息传递模式
- **[自动补全工作流](autocomplete-workflow.md)** - 详细描述路径输入自动补全功能的实现和用户交互

### 测试相关文档
- **[测试指南](testing-guide.md)** - 提供完整的测试策略、测试用例设计和执行指导

## 已知问题汇总

基于代码分析和用户反馈，当前TUI界面存在以下主要问题：

### 1. Tab切换标签未成功
**影响模块**: 结果查看器、配置编辑器
**问题描述**: Tab键无法正常切换标签页
**严重程度**: 高
**状态**: 待修复

### 2. TUI界面加载文件列表失败
**影响模块**: 文件选择器
**问题描述**: 文件列表加载功能存在异常
**严重程度**: 高
**状态**: 待修复

### 3. 配置器管理界面按键无效
**影响模块**: 配置编辑器
**问题描述**: 除Esc和Ctrl+C外，其他按键无响应
**严重程度**: 高
**状态**: 待修复

## 已完成功能

### 1. 自动补全功能 ✅
**影响模块**: 主界面路径输入
**功能描述**: 路径输入时提供智能自动补全建议
**实现状态**: 已完成
**功能特点**:
- Tab键应用选中建议
- 上下键导航建议列表
- ESC键关闭建议列表
- 异步更新避免阻塞UI
- 智能显示和错误处理

## 使用指南

### 开发者使用
1. **代码审查**: 对照工作流文档检查代码实现是否符合设计
2. **问题定位**: 使用文档中的问题分析部分快速定位bug
3. **功能扩展**: 参考现有工作流设计新功能的实现方案

### 测试人员使用
1. **测试用例设计**: 基于工作流文档设计覆盖所有功能路径的测试用例
2. **问题验证**: 使用测试指南验证已知问题的修复情况
3. **回归测试**: 确保功能修改不影响现有工作流

### 维护人员使用
1. **故障排查**: 通过工作流图快速理解功能逻辑，定位问题根因
2. **性能优化**: 识别工作流中的性能瓶颈和优化点
3. **文档更新**: 功能变更时同步更新对应的工作流文档

## 快速参考

### 键盘快捷键
| 功能 | 快捷键 | 适用模块 |
|------|--------|----------|
| 退出程序 | Ctrl+C / q | 全局 |
| 返回上级 | Esc | 全局 |
| 切换标签页 | Tab | 结果查看器、配置编辑器 |
| 上下移动 | ↑/↓ 或 k/j | 文件选择器、结果查看器、配置编辑器、自动补全 |
| 确认选择 | Enter | 文件选择器 |
| 全选 | a | 文件选择器 |
| 取消全选 | n | 文件选择器 |
| 反选 | i | 文件选择器 |
| 保存 | s | 结果查看器、配置编辑器 |
| 应用自动补全 | Tab | 自动补全（建议列表显示时） |
| 选择自动补全建议 | ↑/↓ | 自动补全（建议列表显示时） |
| 关闭自动补全 | Esc | 自动补全（建议列表显示时） |

### 状态转换图
```
StateInput → StateSelect → StateProcessing → StateResult
     ↓           ↓              ↓              ↓
StateConfig   返回          错误处理       返回主界面
```

### 消息流概览
```
用户操作 → 键盘事件 → 模型更新 → 消息发送 → 状态转换 → 视图重绘
```

## 更新日志

### v1.0.0 (当前版本)
- 创建完整的工作流文档集合
- 识别并记录主要功能问题
- 提供详细的测试指导方案

## 贡献指南

### 文档更新
1. 功能变更时及时更新对应的工作流文档
2. 发现问题时记录到已知问题汇总
3. 添加新的测试用例和验证方法

### 代码改进
1. 修复已知问题时更新文档状态
2. 优化工作流时同步更新文档描述
3. 添加新功能时创建对应的工作流文档

## 相关资源

- [Bubble Tea 框架文档](https://github.com/charmbracelet/bubbletea)
- [Go 测试最佳实践](https://golang.org/doc/tutorial/add-a-test)
- [TUI 设计原则](https://github.com/charmbracelet/lipgloss)

## 联系方式

如有问题或建议，请通过以下方式联系：
- 提交Issue到项目仓库
- 发送邮件到开发团队
- 在讨论区发起话题