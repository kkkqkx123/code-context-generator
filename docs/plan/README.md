# 代码上下文生成器 - 双入口点改进计划

## 📋 项目概述

本项目包含两个主要的程序入口点，分别服务于不同的使用场景。当前存在配置复用不足的问题，本计划旨在解决这些问题并提供清晰的使用指导。

## 📁 文档结构

```
docs/plan/
├── README.md                           # 本文件 - 项目总览
├── dual-entry-points-analysis.md       # 双入口点架构分析
├── improvement-implementation-plan.md    # 配置复用改进实施计划
├── usage-guidelines.md                 # 使用指南和最佳实践
└── [其他相关文档]
```

## 🔍 问题识别

### 主要问题
1. **配置复用不足**：根目录 `main.go` 未使用配置文件、环境变量和忽略规则
2. **工具复用缺失**：两个入口点使用不同的处理逻辑和工具链
3. **用户体验不一致**：参数格式、输出质量和错误处理存在差异

### 具体表现
- 根目录版本使用硬编码的排除规则（`.git`, `node_modules`等）
- 不支持 `config.yaml` 配置文件
- 不支持环境变量配置
- 输出格式可能与CLI版本不一致

## 🎯 改进目标

### 短期目标（配置复用）
- ✅ 使根目录 `main.go` 支持配置文件加载
- ✅ 统一使用环境变量和忽略规则
- ✅ 保持向后兼容性和简单易用特点

### 长期目标（体验统一）
- 🔄 标准化输出格式和处理逻辑
- 🔄 统一错误处理机制
- 🔄 提供一致的参数支持

## 🚀 实施计划

### 阶段一：配置复用改进（高优先级）

**修改文件**：`d:/ide/tool/code-context-generator/main.go`

**核心改动**：
1. 添加配置管理器初始化和配置加载
2. 使用配置文件中的忽略规则和处理参数
3. 保持现有交互体验和简单性

**预期效果**：
- 根目录版本将使用与CLI版本相同的配置体系
- 支持 `config.yaml` 和环境变量
- 保持零学习成本的特点

### 阶段二：工具链统一（中优先级）

**改进内容**：
1. 统一文件系统遍历器使用
2. 标准化输出格式处理
3. 错误处理机制统一

### 阶段三：功能增强（低优先级）

**可选改进**：
1. 支持更多CLI版本的参数选项
2. 增强交互式体验
3. 完善文档和测试覆盖

## 📊 入口点对比

| 特性 | 根目录 main.go | cmd/cli/main.go |
|------|---------------|-----------------|
| **目标用户** | 新手用户、快速体验 | 专业用户、自动化 |
| **学习成本** | 零成本 | 中等 |
| **功能完整度** | 基础功能 | 完整功能 |
| **配置支持** | ⚠️ 改进中 | ✅ 完整支持 |
| **自动化支持** | ⚠️ 基础支持 | ✅ 完整支持 |
| **交互体验** | 强制交互 | 可选交互 |

## 💡 使用建议

### 🟢 推荐使用根目录 main.go
- 个人项目文档生成
- 快速原型验证
- 教学和演示场景
- 不喜欢复杂命令的用户

### 🟢 推荐使用 cmd/cli/main.go
- 企业级项目和团队协作
- 自动化构建和部署
- 需要精细控制的场景
- 专业开发者和高级用户

## 🔧 快速开始

### 根目录版本（改进后）
```bash
# 快速体验（交互模式）
go run main.go

# 指定格式和输出
go run main.go -f markdown -o project-docs.md

# 使用配置文件
echo "filters:" > config.yaml
echo "  exclude_patterns:" >> config.yaml
echo "    - \"*.log\"" >> config.yaml
go run main.go -f markdown -o docs.md
```

### CLI版本
```bash
# 基本使用
go run cmd/cli/main.go generate -f markdown -o docs.md

# 高级过滤
go run cmd/cli/main.go generate \
  -f markdown \
  -o docs.md \
  --exclude-patterns "*_test.go,*.tmp" \
  --max-depth 3

# 配置管理
go run cmd/cli/main.go config show
```

## 📈 改进进展

### 当前状态
- ✅ 问题分析和方案设计完成
- ✅ 改进实施计划制定
- ✅ 使用指南编写
- 🔄 等待代码实施

### 下一步行动
1. **代码实施**：按照 `improvement-implementation-plan.md` 修改根目录 `main.go`
2. **测试验证**：确保改进后的功能正常工作
3. **文档更新**：根据实际实施结果更新文档
4. **用户反馈**：收集用户使用反馈，持续优化

## 🤝 贡献指南

欢迎贡献改进建议：

1. **问题反馈**：在使用中发现问题请提交issue
2. **功能建议**：有新的功能想法欢迎讨论
3. **文档改进**：发现文档问题可以提交修改
4. **代码贡献**：欢迎提交PR改进代码质量

## 📞 联系方式

如有问题或建议，请通过以下方式联系：
- 提交GitHub Issue
- 查看项目文档
- 参考使用指南

---

**注意**：本文档描述的是改进计划，具体实施可能需要根据实际情况调整。建议在实施前充分测试，确保不影响现有功能。