# æ¶æ„åˆ†æåŠŸèƒ½æ‰©å±•è®¡åˆ’

## åŠŸèƒ½æ¦‚è¿°

åŸºäºrepomixçš„æ¶æ„åˆ†æåŠŸèƒ½ï¼Œä¸ºé¡¹ç›®æ·»åŠ ä»£ç æ¶æ„å¯è§†åŒ–ã€ä¾èµ–å…³ç³»åˆ†æå’Œæ¶æ„è´¨é‡è¯„ä¼°èƒ½åŠ›ï¼Œå¸®åŠ©å¼€å‘è€…ç†è§£ä»£ç ç»“æ„å’Œæ”¹è¿›æ¶æ„è®¾è®¡ã€‚

## å½“å‰çŠ¶æ€åˆ†æ

### ç°æœ‰åŠŸèƒ½
- âŒ æ— æ¶æ„åˆ†æåŠŸèƒ½
- âŒ æ— æ³•å¯è§†åŒ–ä»£ç ç»“æ„
- âŒ ç¼ºå°‘ä¾èµ–å…³ç³»åˆ†æ

### ä¸repomixå¯¹æ¯”
- âŒ ç¼ºå°‘æ¶æ„å¯è§†åŒ–
- âŒ ç¼ºå°‘ä¾èµ–åˆ†æ
- âŒ ç¼ºå°‘è´¨é‡è¯„ä¼°

## æ‰©å±•ç›®æ ‡

### æ ¸å¿ƒåŠŸèƒ½
1. **ä»£ç ç»“æ„åˆ†æ** - åŒ…ã€æ¨¡å—ã€ç±»å±‚æ¬¡ç»“æ„
2. **ä¾èµ–å…³ç³»å¯è§†åŒ–** - å¯¼å…¥/å¯¼å‡ºå…³ç³»å›¾
3. **æ¶æ„è´¨é‡è¯„ä¼°** - è€¦åˆåº¦ã€å†…èšæ€§æŒ‡æ ‡
4. **æ¶æ„å»ºè®®ç”Ÿæˆ** - æ”¹è¿›å»ºè®®å’Œé‡æ„æŒ‡å¯¼

### åˆ†æç»´åº¦
- **é™æ€åˆ†æ** - ä»£ç ç»“æ„è§£æ
- **åŠ¨æ€åˆ†æ** - è¿è¡Œæ—¶ä¾èµ–å…³ç³»
- **è´¨é‡åˆ†æ** - æ¶æ„æŒ‡æ ‡è®¡ç®—
- **å¯è§†åŒ–åˆ†æ** - å›¾å½¢åŒ–å±•ç¤º

## æŠ€æœ¯å®ç°æ–¹æ¡ˆ

### 1. æ¶æ„åˆ†æå¼•æ“

#### æ ¸å¿ƒæ¶æ„
```go
type ArchitectureAnalyzer struct {
    parsers      map[string]CodeParser
    analyzers    []ArchitectureAnalyzer
    visualizers  []ArchitectureVisualizer
    config       AnalysisConfig
}

type CodeParser interface {
    Parse(filePath string, content string) (*CodeStructure, error)
    GetSupportedLanguages() []string
}

type ArchitectureAnalyzer interface {
    Analyze(structure *ProjectStructure) *AnalysisResult
    GetName() string
}
```

#### åˆ†æå™¨ç±»å‹
- **ç»“æ„åˆ†æå™¨** - åŒ…/æ¨¡å—/ç±»å±‚æ¬¡
- **ä¾èµ–åˆ†æå™¨** - å¯¼å…¥/å¯¼å‡ºå…³ç³»
- **è´¨é‡åˆ†æå™¨** - æ¶æ„æŒ‡æ ‡è®¡ç®—
- **æ¨¡å¼æ£€æµ‹å™¨** - æ¶æ„æ¨¡å¼è¯†åˆ«

### 2. ä»£ç ç»“æ„è§£æ

#### é¡¹ç›®ç»“æ„è¡¨ç¤º
```go
type ProjectStructure struct {
    Name         string                 `json:"name"`
    RootPath     string                 `json:"root_path"`
    Languages    map[string]LanguageInfo `json:"languages"`
    
    Packages     []PackageInfo          `json:"packages"`
    Modules      []ModuleInfo           `json:"modules"`
    Files        []FileInfo             `json:"files"`
    
    Dependencies []DependencyInfo       `json:"dependencies"`
    Metrics      ArchitectureMetrics    `json:"metrics"`
}

type PackageInfo struct {
    Name        string       `json:"name"`
    Path        string       `json:"path"`
    Files       []FileInfo   `json:"files"`
    Dependencies []string    `json:"dependencies"`
    Metrics     PackageMetrics `json:"metrics"`
}

type DependencyInfo struct {
    Source      string       `json:"source"`
    Target      string       `json:"target"`
    Type        DependencyType `json:"type"`
    Strength    int          `json:"strength"`
    Description string       `json:"description"`
}
```

### 3. æ¶æ„è´¨é‡æŒ‡æ ‡

#### è´¨é‡æŒ‡æ ‡ä½“ç³»
```go
type ArchitectureMetrics struct {
    // è€¦åˆåº¦æŒ‡æ ‡
    Coupling struct {
        AfferentCoupling  int     `json:"afferent_coupling"`    // ä¼ å…¥è€¦åˆ
        EfferentCoupling  int     `json:"efferent_coupling"`    // ä¼ å‡ºè€¦åˆ
        Instability      float64 `json:"instability"`          // ä¸ç¨³å®šæ€§
        Abstractness     float64 `json:"abstractness"`         // æŠ½è±¡åº¦
    } `json:"coupling"`
    
    // å†…èšæ€§æŒ‡æ ‡
    Cohesion struct {
        LackOfCohesion   float64 `json:"lack_of_cohesion"`     // ç¼ºä¹å†…èš
        ModuleCohesion   float64 `json:"module_cohesion"`      // æ¨¡å—å†…èš
        FunctionalCohesion float64 `json:"functional_cohesion"` # åŠŸèƒ½å†…èš
    } `json:"cohesion"`
    
    // å¤æ‚åº¦æŒ‡æ ‡
    Complexity struct {
        Cyclomatic       float64 `json:"cyclomatic"`           # åœˆå¤æ‚åº¦
        Cognitive        float64 `json:"cognitive"`             # è®¤çŸ¥å¤æ‚åº¦
        Structural       float64 `json:"structural"`           # ç»“æ„å¤æ‚åº¦
    } `json:"complexity"`
    
    // è§„æ¨¡æŒ‡æ ‡
    Size struct {
        LinesOfCode      int     `json:"lines_of_code"`        # ä»£ç è¡Œæ•°
        FilesCount       int     `json:"files_count"`          # æ–‡ä»¶æ•°é‡
        PackagesCount    int     `json:"packages_count"`       # åŒ…æ•°é‡
        FunctionsCount   int     `json:"functions_count"`       # å‡½æ•°æ•°é‡
    } `json:"size"`
}
```

### 4. å¯è§†åŒ–ç³»ç»Ÿ

#### å›¾å½¢åŒ–è¾“å‡º
```go
type ArchitectureVisualizer interface {
    Visualize(structure *ProjectStructure, config VisualizationConfig) ([]byte, error)
    GetSupportedFormats() []string
}

// æ”¯æŒçš„è¾“å‡ºæ ¼å¼
type VisualizationFormat string

const (
    FormatDOT    VisualizationFormat = "dot"     # Graphviz DOTæ ¼å¼
    FormatMermaid VisualizationFormat = "mermaid" # Mermaidæ ¼å¼
    FormatJSON   VisualizationFormat = "json"    # JSONæ ¼å¼
    FormatHTML   VisualizationFormat = "html"    # äº¤äº’å¼HTML
    FormatPlantUML VisualizationFormat = "plantuml" # PlantUMLæ ¼å¼
)
```

### 5. é…ç½®ç³»ç»Ÿ

#### åˆ†æé…ç½®ç»“æ„
```yaml
architecture:
  enabled: false
  analysis_level: "standard"  # basic, standard, comprehensive
  
  # åˆ†æå™¨é…ç½®
  analyzers:
    structure_analysis:
      enabled: true
      depth: 3                # åˆ†ææ·±åº¦
    
    dependency_analysis:
      enabled: true
      include_external: false  # åŒ…å«å¤–éƒ¨ä¾èµ–
      transitive_deps: true    # ä¼ é€’ä¾èµ–
    
    quality_analysis:
      enabled: true
      metrics:
        - "coupling"
        - "cohesion"
        - "complexity"
        - "size"
    
    pattern_detection:
      enabled: false
      patterns:
        - "mvc"
        - "layered"
        - "microservices"
  
  # å¯è§†åŒ–é…ç½®
  visualization:
    enabled: true
    format: "mermaid"  # dot, mermaid, json, html, plantuml
    output_file: "architecture_diagram.md"
    
    # å›¾å½¢æ ·å¼
    style:
      theme: "default"
      node_shape: "rect"
      edge_style: "solid"
      colors: true
    
    # å¸ƒå±€é€‰é¡¹
    layout:
      hierarchical: true
      rankdir: "TB"      # TB, LR, RL, BT
      nodesep: 0.5
      ranksep: 0.5
  
  # æŠ¥å‘Šé…ç½®
  reporting:
    enabled: true
    format: "text"  # text, json, html
    output_file: "architecture_report.txt"
    
    include_metrics: true
    include_recommendations: true
    include_visualization: true
```

## å®æ–½æ­¥éª¤

### ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€åˆ†æï¼ˆ4å‘¨ï¼‰
1. **ä»£ç ç»“æ„è§£æ**
   - Goè¯­è¨€ç»“æ„åˆ†æ
   - åŒ…/æ¨¡å—è¯†åˆ«
   - ä¾èµ–å…³ç³»æå–

2. **åŸºç¡€å¯è§†åŒ–**
   - DOTæ ¼å¼è¾“å‡º
   - Mermaidæ ¼å¼æ”¯æŒ
   - å‘½ä»¤è¡Œé›†æˆ

### ç¬¬äºŒé˜¶æ®µï¼šè´¨é‡åˆ†æï¼ˆ3å‘¨ï¼‰
3. **æ¶æ„æŒ‡æ ‡è®¡ç®—**
   - è€¦åˆåº¦æŒ‡æ ‡
   - å†…èšæ€§æŒ‡æ ‡
   - å¤æ‚åº¦æŒ‡æ ‡

4. **é«˜çº§å¯è§†åŒ–**
   - äº¤äº’å¼HTMLæŠ¥å‘Š
   - å›¾å½¢æ ·å¼å®šåˆ¶
   - å¤šæ ¼å¼æ”¯æŒ

### ç¬¬ä¸‰é˜¶æ®µï¼šé«˜çº§åŠŸèƒ½ï¼ˆ3å‘¨ï¼‰
5. **æ¨¡å¼æ£€æµ‹**
   - æ¶æ„æ¨¡å¼è¯†åˆ«
   - åæ¨¡å¼æ£€æµ‹
   - é‡æ„å»ºè®®ç”Ÿæˆ

6. **å¤šè¯­è¨€æ”¯æŒ**
   - JavaScript/TypeScript
   - Python
   - Java

## ä»£ç æ¶æ„

### æ–°å¢åŒ…ç»“æ„
```
internal/architecture/
â”œâ”€â”€ analyzer.go           # æ¶æ„åˆ†æå™¨ä¸»æ¥å£
â”œâ”€â”€ parsers/             # ä»£ç è§£æå™¨
â”‚   â”œâ”€â”€ go_parser.go      # Goè¯­è¨€è§£æå™¨
â”‚   â”œâ”€â”€ javascript_parser.go # JavaScriptè§£æå™¨
â”‚   â””â”€â”€ generic_parser.go # é€šç”¨è§£æå™¨
â”œâ”€â”€ analyzers/           # åˆ†æå™¨å®ç°
â”‚   â”œâ”€â”€ structure_analyzer.go    # ç»“æ„åˆ†æ
â”‚   â”œâ”€â”€ dependency_analyzer.go   # ä¾èµ–åˆ†æ
â”‚   â”œâ”€â”€ quality_analyzer.go     # è´¨é‡åˆ†æ
â”‚   â””â”€â”€ pattern_detector.go      # æ¨¡å¼æ£€æµ‹
â”œâ”€â”€ visualizers/         # å¯è§†åŒ–å™¨
â”‚   â”œâ”€â”€ dot_visualizer.go       # DOTå¯è§†åŒ–
â”‚   â”œâ”€â”€ mermaid_visualizer.go   # Mermaidå¯è§†åŒ–
â”‚   â”œâ”€â”€ html_visualizer.go      # HTMLå¯è§†åŒ–
â”‚   â””â”€â”€ plantuml_visualizer.go  # PlantUMLå¯è§†åŒ–
â”œâ”€â”€ metrics/            # æŒ‡æ ‡è®¡ç®—
â”‚   â”œâ”€â”€ coupling_metrics.go     # è€¦åˆåº¦æŒ‡æ ‡
â”‚   â”œâ”€â”€ cohesion_metrics.go     # å†…èšæ€§æŒ‡æ ‡
â”‚   â”œâ”€â”€ complexity_metrics.go   # å¤æ‚åº¦æŒ‡æ ‡
â”‚   â””â”€â”€ size_metrics.go         # è§„æ¨¡æŒ‡æ ‡
â””â”€â”€ reporting/          # æŠ¥å‘Šç³»ç»Ÿ
    â”œâ”€â”€ reporter.go
    â”œâ”€â”€ text_reporter.go
    â”œâ”€â”€ json_reporter.go
    â””â”€â”€ html_reporter.go

pkg/types/
â”œâ”€â”€ architecture_config.go # æ¶æ„é…ç½®
â”œâ”€â”€ project_structure.go   # é¡¹ç›®ç»“æ„
â”œâ”€â”€ architecture_metrics.go # æ¶æ„æŒ‡æ ‡
â””â”€â”€ visualization_config.go # å¯è§†åŒ–é…ç½®
```

### ä¾èµ–ç®¡ç†
- **æ ¸å¿ƒä¾èµ–**: æ ‡å‡†åº“
- **å¯è§†åŒ–**: æ¨¡æ¿å¼•æ“ï¼ˆHTMLæŠ¥å‘Šï¼‰
- **å›¾å½¢ç”Ÿæˆ**: å¤–éƒ¨å·¥å…·é›†æˆï¼ˆGraphvizç­‰ï¼‰

## å‘½ä»¤è¡Œå‚æ•°

### æ–°å¢å‚æ•°
```bash
# æ¶æ„åˆ†æåŠŸèƒ½
--architecture-analysis      # å¯ç”¨æ¶æ„åˆ†æ
--no-architecture-analysis  # ç¦ç”¨æ¶æ„åˆ†æ
--analysis-level <level>    # åˆ†æçº§åˆ«

# åˆ†æå™¨æ§åˆ¶
--enable-analyzer <name>    # å¯ç”¨ç‰¹å®šåˆ†æå™¨
--disable-analyzer <name>   # ç¦ç”¨ç‰¹å®šåˆ†æå™¨
--analyze-dependencies      # åˆ†æä¾èµ–å…³ç³»
--calculate-metrics        # è®¡ç®—æ¶æ„æŒ‡æ ‡

# å¯è§†åŒ–é€‰é¡¹
--visualize-architecture    # ç”Ÿæˆæ¶æ„å›¾
--visualization-format <format> # å¯è§†åŒ–æ ¼å¼
--output-diagram <file>     # è¾“å‡ºå›¾è¡¨æ–‡ä»¶

# æŠ¥å‘Šé€‰é¡¹
--architecture-report <file> # ç”Ÿæˆæ¶æ„æŠ¥å‘Š
--report-format <format>    # æŠ¥å‘Šæ ¼å¼
--include-recommendations   # åŒ…å«æ”¹è¿›å»ºè®®
```

## è¾“å‡ºç¤ºä¾‹

### æ¶æ„æŠ¥å‘Šç¤ºä¾‹
```
Architecture Analysis Report
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š Project Overview:
   â€¢ Project: code-context-generator
   â€¢ Languages: Go (100%)
   â€¢ Files: 45
   â€¢ Packages: 8
   â€¢ Functions: 156

ğŸ—ï¸ Architecture Quality Metrics:
   ğŸ”— Coupling:
      â€¢ Afferent Coupling: 12 (Good)
      â€¢ Efferent Coupling: 8 (Good)
      â€¢ Instability: 0.4 (Stable)
      â€¢ Abstractness: 0.6 (Balanced)
   
   ğŸ”— Cohesion:
      â€¢ Lack of Cohesion: 0.2 (High Cohesion)
      â€¢ Module Cohesion: 0.8 (Good)
   
   âš¡ Complexity:
      â€¢ Average Cyclomatic: 3.2 (Low)
      â€¢ Cognitive Complexity: 15.6 (Moderate)

ğŸ“ˆ Dependency Graph:
```mermaid
graph TD
    A[cli] --> B[internal/config]
    A --> C[internal/filesystem]
    B --> D[internal/env]
    C --> D
    C --> E[pkg/types]
    D --> F[internal/utils]
```

ğŸ’¡ Architecture Recommendations:
   âœ… Strengths:
      â€¢ Good package separation
      â€¢ Low coupling between modules
      â€¢ High cohesion within packages
   
   âš ï¸ Areas for Improvement:
      â€¢ Consider extracting shared utilities to a common package
      â€¢ Some packages have high efferent coupling
      â€¢ Add interface abstraction for better testability
```

### å¯è§†åŒ–è¾“å‡ºç¤ºä¾‹

#### Mermaidæ ¼å¼
```mermaid
graph TB
    subgraph "Core Packages"
        CLI[cli/main.go]
        Config[internal/config]
        FS[internal/filesystem]
    end
    
    subgraph "Support Packages"
        Env[internal/env]
        Utils[internal/utils]
        Types[pkg/types]
    end
    
    CLI --> Config
    CLI --> FS
    Config --> Env
    FS --> Env
    FS --> Types
    Env --> Utils
```

#### HTMLäº¤äº’å¼æŠ¥å‘Š
ç”ŸæˆåŒ…å«å¯äº¤äº’ä¾èµ–å›¾ã€æŒ‡æ ‡å›¾è¡¨å’Œè¯¦ç»†åˆ†æçš„å¯è§†åŒ–æŠ¥å‘Šã€‚

## æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•
- è§£æå™¨å‡†ç¡®æ€§æµ‹è¯•
- æŒ‡æ ‡è®¡ç®—é€»è¾‘æµ‹è¯•
- å¯è§†åŒ–ç”Ÿæˆæµ‹è¯•

### é›†æˆæµ‹è¯•
- çœŸå®é¡¹ç›®åˆ†ææµ‹è¯•
- å¤šè¯­è¨€å…¼å®¹æ€§æµ‹è¯•
- æ€§èƒ½åŸºå‡†æµ‹è¯•

### è´¨é‡æµ‹è¯•
- åˆ†æå‡†ç¡®æ€§éªŒè¯
- å¯è§†åŒ–æ­£ç¡®æ€§æµ‹è¯•
- æŠ¥å‘Šå®Œæ•´æ€§æµ‹è¯•

## æ€§èƒ½è€ƒè™‘

### ä¼˜åŒ–ç­–ç•¥
- **å¢é‡åˆ†æ**: åªåˆ†æå˜æ›´æ–‡ä»¶
- **ç¼“å­˜æœºåˆ¶**: è§£æç»“æœç¼“å­˜
- **å¹¶è¡Œå¤„ç†**: å¤šæ–‡ä»¶å¹¶è¡Œåˆ†æ
- **æ‡’åŠ è½½**: æŒ‰éœ€åŠ è½½åˆ†æå™¨

### æ€§èƒ½æŒ‡æ ‡
- åˆ†æé€Ÿåº¦: < 500ms/100æ–‡ä»¶
- å†…å­˜ä½¿ç”¨: < 200MB
- å¯è§†åŒ–ç”Ÿæˆ: < 2s

## é£é™©è¯„ä¼°

### æŠ€æœ¯é£é™©
- å¤šè¯­è¨€è§£æå¤æ‚æ€§
- å¤§å‹é¡¹ç›®æ€§èƒ½é—®é¢˜
- å¯è§†åŒ–å‡†ç¡®æ€§

### ç¼“è§£æªæ–½
- æ¸è¿›å¼åŠŸèƒ½å¯ç”¨
- æ€§èƒ½ç›‘æ§å’Œé™åˆ¶
- å¯é…ç½®çš„åˆ†ææ·±åº¦

## æˆåŠŸæŒ‡æ ‡

### åŠŸèƒ½æŒ‡æ ‡
- æ”¯æŒ5+ç¼–ç¨‹è¯­è¨€
- ç”Ÿæˆ10+æ¶æ„æŒ‡æ ‡
- æ”¯æŒ5+å¯è§†åŒ–æ ¼å¼

### è´¨é‡æŒ‡æ ‡
- åˆ†æå‡†ç¡®æ€§ > 90%
- å¯è§†åŒ–æ­£ç¡®æ€§ > 95%
- ç”¨æˆ·ä½“éªŒè‰¯å¥½

## åç»­æ‰©å±•

### çŸ­æœŸæ‰©å±•
- æ›´å¤šæ¶æ„æ¨¡å¼æ£€æµ‹
- å®æ—¶æ¶æ„ç›‘æ§
- IDEæ’ä»¶é›†æˆ

### é•¿æœŸæ‰©å±•
- AIé©±åŠ¨çš„æ¶æ„ä¼˜åŒ–
- æ¶æ„æ¼”è¿›åˆ†æ
- å›¢é˜Ÿåä½œåŠŸèƒ½